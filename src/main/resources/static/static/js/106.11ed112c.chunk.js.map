{"version":3,"file":"static/js/106.11ed112c.chunk.js","mappings":"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","sources":["pages/AudiencePage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { getRealtimeAudienceData } from '../apiConfig';\r\nimport { FaUserCircle, FaMapMarkedAlt, FaMobileAlt, FaDesktop, FaClock, FaRedo, FaExclamationTriangle } from 'react-icons/fa';\r\n\r\n// Helper component for table cell display\r\nconst DetailCell = ({ icon: Icon, value, label }) => (\r\n    <div className=\"flex items-center text-sm text-gray-700\">\r\n        <Icon className=\"text-sky-500 mr-2 flex-shrink-0\" title={label} />\r\n        <span className=\"truncate\" title={value || 'N/A'}>\r\n            {value || 'N/A'}\r\n        </span>\r\n    </div>\r\n);\r\n\r\nconst AudiencePage = () => {\r\n    const [data, setData] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [lastFetchTime, setLastFetchTime] = useState(null);\r\n\r\n    const fetchData = async () => {\r\n        setLoading(true);\r\n        setError('');\r\n        try {\r\n            const response = await getRealtimeAudienceData();\r\n            setData(response.data);\r\n            setLastFetchTime(new Date());\r\n        } catch (err) {\r\n            console.error('Error fetching audience data:', err);\r\n            // Check for 403 Forbidden or 401 Unauthorized errors\r\n            if (err.response && (err.response.status === 403 || err.response.status === 401)) {\r\n                setError('Access Denied. You do not have permission to view this data.');\r\n            } else {\r\n                // Check for 500 error, which might mean GA4 client failed to initialize or authenticate\r\n                setError('Failed to fetch real-time audience data. Check backend logs and GA4 setup.');\r\n            }\r\n            setData([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Polling logic for \"real-time\" feel\r\n    useEffect(() => {\r\n        fetchData(); // Initial fetch\r\n        // Poll every 30 seconds\r\n        const intervalId = setInterval(fetchData, 30000);\r\n\r\n        return () => clearInterval(intervalId); // Cleanup on unmount\r\n    }, []);\r\n\r\n    // Custom function to format data for the table rows\r\n    const columns = [\r\n        {\r\n            key: 'user',\r\n            title: 'Active Sessions',\r\n            render: (item) => <DetailCell icon={FaUserCircle} value={item.user} label=\"Active Users/Sessions\" />\r\n        },\r\n        {\r\n            key: 'location',\r\n            title: 'Location (City, Region, Country)',\r\n            render: (item) => (\r\n                <DetailCell\r\n                    icon={FaMapMarkedAlt}\r\n                    value={`${item.city || 'N/A'}, ${item.region || 'N/A'}, ${item.country || 'N/A'}`}\r\n                    label=\"Location\"\r\n                />\r\n            )\r\n        },\r\n        {\r\n            key: 'device',\r\n            title: 'Device Type',\r\n            render: (item) => (\r\n                <DetailCell\r\n                    icon={item.device === 'mobile' ? FaMobileAlt : FaDesktop}\r\n                    value={item.device}\r\n                    label=\"Device Type\"\r\n                />\r\n            )\r\n        },\r\n        {\r\n            key: 'pagePath',\r\n            title: 'Current Page Path',\r\n            render: (item) => (\r\n                <p className=\"text-xs text-gray-500 truncate max-w-xs\" title={item.pagePath}>\r\n                    {item.pagePath}\r\n                </p>\r\n            )\r\n        },\r\n        {\r\n            key: 'source',\r\n            title: 'Source',\r\n            render: (item) => <p className=\"text-xs text-gray-600 truncate\">{item.source}</p>\r\n        },\r\n        {\r\n            key: 'time',\r\n            title: 'Report Time',\r\n            render: (item) => <p className=\"text-xs text-gray-500\">{new Date().toLocaleTimeString()}</p>\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"container mx-auto p-6 md:p-8\">\r\n            <h1 className=\"text-3xl font-bold text-gray-800 mb-4\">Real-time Audience Analytics</h1>\r\n            <p className=\"text-gray-600 mb-6\">Live snapshot of users on your website, sourced from Google Analytics (GA4).</p>\r\n\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <span className=\"text-sm text-gray-500\">\r\n                    Last updated: {lastFetchTime ? lastFetchTime.toLocaleTimeString() : 'N/A'}\r\n                </span>\r\n                <button\r\n                    onClick={fetchData}\r\n                    disabled={loading}\r\n                    className={`flex items-center px-4 py-2 text-sm rounded-lg transition duration-300 ${loading\r\n                            ? 'bg-gray-300 text-gray-600 cursor-not-allowed'\r\n                            : 'bg-sky-600 text-white hover:bg-sky-700'\r\n                        }`}\r\n                >\r\n                    <FaRedo className={`mr-2 ${loading ? 'animate-spin' : ''}`} />\r\n                    {loading ? 'Loading...' : 'Refresh Now'}\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-lg shadow-lg overflow-x-auto\">\r\n                {error && (\r\n                    <div className=\"p-4 bg-red-100 text-red-700 border-l-4 border-red-500 flex items-center\">\r\n                        <FaExclamationTriangle className=\"mr-3 flex-shrink-0 text-xl\" />\r\n                        <div>\r\n                            <p className=\"font-semibold\">{error}</p>\r\n                            <p className=\"text-sm\">Please ensure your GA4 property ID and Service Account credentials are correctly configured in the backend and that the Service Account has **Viewer** access to your GA4 property.</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {loading && !error && data.length === 0 ? (\r\n                    <div className=\"p-6 text-center text-gray-500\">\r\n                        <FaClock className=\"mx-auto text-3xl mb-2 animate-pulse\" />\r\n                        <p>Fetching real-time data...</p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"min-w-full divide-y divide-gray-200\">\r\n                        <thead className=\"bg-gray-50\">\r\n                            <tr>\r\n                                {columns.map(col => (\r\n                                    <th\r\n                                        key={col.key}\r\n                                        className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap\"\r\n                                    >\r\n                                        {col.title}\r\n                                    </th>\r\n                                ))}\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                            {data.length > 0 ? (\r\n                                data.map((item, index) => (\r\n                                    <tr key={index} className=\"hover:bg-sky-50/50\">\r\n                                        {columns.map(col => (\r\n                                            <td key={col.key} className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                {col.render(item)}\r\n                                            </td>\r\n                                        ))}\r\n                                    </tr>\r\n                                ))\r\n                            ) : (\r\n                                !error && (\r\n                                    <tr>\r\n                                        <td colSpan={columns.length} className=\"px-6 py-12 text-center text-gray-500\">\r\n                                            <FaDesktop className=\"mx-auto text-4xl mb-4 text-gray-400\" />\r\n                                            <p className=\"text-lg font-semibold\">No active users detected in the last 30 minutes.</p>\r\n                                            <p className=\"text-sm\">Data refreshes every 30 seconds.</p>\r\n                                        </td>\r\n                                    </tr>\r\n                                )\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AudiencePage;"],"names":["DetailCell","_ref","icon","Icon","value","label","_jsxs","className","children","_jsx","title","AudiencePage","data","setData","useState","loading","setLoading","error","setError","lastFetchTime","setLastFetchTime","fetchData","async","response","getRealtimeAudienceData","Date","err","console","status","useEffect","intervalId","setInterval","clearInterval","columns","key","render","item","FaUserCircle","user","FaMapMarkedAlt","concat","city","region","country","device","FaMobileAlt","FaDesktop","pagePath","source","toLocaleTimeString","onClick","disabled","FaRedo","FaExclamationTriangle","length","FaClock","map","col","index","colSpan"],"sourceRoot":""}