{"version":3,"file":"static/js/106.a36c82c3.chunk.js","mappings":"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","sources":["pages/AudiencePage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { getHistoricalAudienceData } from '../apiConfig';\r\nimport { FaCalendarAlt, FaMapMarkedAlt, FaMobileAlt, FaDesktop, FaClock, FaRedo, FaExclamationTriangle, FaChartBar, FaUser, FaGlobe, FaSearch } from 'react-icons/fa';\r\n\r\n// Helper component for table cell display\r\nconst DetailCell = ({ icon: Icon, value, label }) => (\r\n    <div className=\"flex items-center text-sm text-gray-700\">\r\n        <Icon className=\"text-sky-500 mr-2 flex-shrink-0\" title={label} />\r\n        <span className=\"truncate\" title={value || 'N/A'}>\r\n            {value || 'N/A'}\r\n        </span>\r\n    </div>\r\n);\r\n\r\n// Function to format today's date in YYYY-MM-DD format\r\nconst getTodayDateString = () => {\r\n    return new Date().toISOString().split('T')[0];\r\n};\r\n\r\nconst AudiencePage = () => {\r\n    const [data, setData] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [startDate, setStartDate] = useState(getTodayDateString());\r\n    const [endDate, setEndDate] = useState(getTodayDateString());\r\n\r\n    // NEW FILTER STATES\r\n    const [countryFilter, setCountryFilter] = useState('');\r\n    const [regionFilter, setRegionFilter] = useState('');\r\n    const [deviceCategoryFilter, setDeviceCategoryFilter] = useState('');\r\n\r\n    const [lastFetchTime, setLastFetchTime] = useState(null);\r\n\r\n    // MODIFIED: Added filter parameters\r\n    const fetchData = async (start, end, country, region, deviceCategory) => {\r\n        setLoading(true);\r\n        setError('');\r\n\r\n        // Simple validation\r\n        if (!start || !end || new Date(start) > new Date(end)) {\r\n            setError('Invalid date range. Start date must be before or equal to the end date.');\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // MODIFIED: Pass all filter parameters\r\n            const response = await getHistoricalAudienceData(start, end, country, region, deviceCategory);\r\n            setData(response.data);\r\n            setLastFetchTime(new Date());\r\n        } catch (err) {\r\n            console.error('Error fetching audience data:', err);\r\n            if (err.response && (err.response.status === 403 || err.response.status === 401)) {\r\n                setError('Access Denied. You do not have permission to view this data.');\r\n            } else {\r\n                setError('Failed to fetch historical audience data. Check backend logs and GA4 setup. The last attempt to fetch historical data might have failed.');\r\n            }\r\n            setData([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Initial fetch when component mounts: loads last 7 days of data\r\n    useEffect(() => {\r\n        const today = new Date();\r\n        const defaultStart = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\r\n        setStartDate(defaultStart);\r\n        // MODIFIED: Call with empty filters on initial load\r\n        fetchData(defaultStart, getTodayDateString(), countryFilter, regionFilter, deviceCategoryFilter);\r\n    }, []);\r\n\r\n    const handleDateChange = (e, type) => {\r\n        const value = e.target.value;\r\n        if (type === 'start') {\r\n            setStartDate(value);\r\n        } else {\r\n            setEndDate(value);\r\n        }\r\n    };\r\n\r\n    const handleSearchClick = () => {\r\n        // MODIFIED: Pass all filter states to fetchData\r\n        fetchData(startDate, endDate, countryFilter, regionFilter, deviceCategoryFilter);\r\n    };\r\n\r\n    const columns = [\r\n        {\r\n            key: 'sessionDate',\r\n            title: 'Date',\r\n            render: (item) => <DetailCell icon={FaCalendarAlt} value={item.sessionDate} label=\"Session Date\" />\r\n        },\r\n        {\r\n            key: 'location',\r\n            title: 'Location (City, Region, Country)',\r\n            render: (item) => (\r\n                <DetailCell\r\n                    icon={FaMapMarkedAlt}\r\n                    value={`${item.city || 'N/A'}, ${item.region || 'N/A'}, ${item.country || 'N/A'}`}\r\n                    label=\"Location\"\r\n                />\r\n            )\r\n        },\r\n        {\r\n            key: 'device',\r\n            title: 'Device & OS',\r\n            render: (item) => (\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"text-xs text-gray-700 font-semibold\">\r\n                        <FaMobileAlt className=\"inline mr-1 text-sky-500\" /> {item.deviceCategory} ({item.deviceModel || 'N/A'})\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                        <FaGlobe className=\"inline mr-1 text-sky-500\" /> {item.operatingSystem} ({item.osVersion || 'N/A'})\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                        <FaDesktop className=\"inline mr-1 text-sky-500\" /> Resolution: {item.screenResolution || 'N/A'}\r\n                    </p>\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            key: 'traffic',\r\n            title: 'Source & Landing Page',\r\n            render: (item) => (\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"text-xs text-gray-700 font-semibold\">Source: {item.sessionSource}</p>\r\n                    <p className=\"text-xs text-gray-500 truncate max-w-xs\" title={item.landingPage}>Landing: {item.landingPage}</p>\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            key: 'time',\r\n            title: 'Time & Views',\r\n            render: (item) => (\r\n                <div className=\"space-y-1\">\r\n                    <p className=\"text-xs text-gray-700 font-semibold\">\r\n                        <FaClock className=\"inline mr-1 text-sky-500\" /> {item.timeOnSiteFormatted}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                        <FaChartBar className=\"inline mr-1 text-sky-500\" /> Sessions: {item.views}\r\n                    </p>\r\n                    <p className=\"text-xs text-gray-500\">\r\n                        <FaUser className=\"inline mr-1 text-sky-500\" /> ID: {item.userIdentifier ? item.userIdentifier.substring(0, 8) + '...' : 'N/A'}\r\n                    </p>\r\n                </div>\r\n            )\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <div className=\"container mx-auto p-6 md:p-8\">\r\n            <h1 className=\"text-3xl font-bold text-gray-800 mb-4\">Historical Audience Report</h1>\r\n            <p className=\"text-gray-600 mb-6\">Detailed visitor logs stored in the database. Data is synchronized daily from Google Analytics (GA4).</p>\r\n\r\n            {/* START: Filter Row (Date Filters) */}\r\n            <div className=\"bg-white p-4 rounded-lg shadow-sm mb-4 flex flex-wrap items-center justify-between space-y-2 md:space-y-0 md:space-x-4\">\r\n                <div className=\"flex items-center space-x-2 w-full md:w-auto\">\r\n                    <label htmlFor=\"startDate\" className=\"text-sm font-medium text-gray-700 flex-shrink-0\">From:</label>\r\n                    <input\r\n                        type=\"date\"\r\n                        id=\"startDate\"\r\n                        value={startDate}\r\n                        onChange={(e) => handleDateChange(e, 'start')}\r\n                        className=\"p-2 border border-gray-300 rounded-lg w-full text-sm\"\r\n                        disabled={loading}\r\n                    />\r\n                </div>\r\n                <div className=\"flex items-center space-x-2 w-full md:w-auto\">\r\n                    <label htmlFor=\"endDate\" className=\"text-sm font-medium text-gray-700 flex-shrink-0\">To:</label>\r\n                    <input\r\n                        type=\"date\"\r\n                        id=\"endDate\"\r\n                        value={endDate}\r\n                        onChange={(e) => handleDateChange(e, 'end')}\r\n                        className=\"p-2 border border-gray-300 rounded-lg w-full text-sm\"\r\n                        disabled={loading}\r\n                    />\r\n                </div>\r\n                <div className=\"w-full md:w-auto mt-2 md:mt-0\">\r\n                    <button\r\n                        onClick={handleSearchClick}\r\n                        disabled={loading}\r\n                        className={`flex items-center px-4 py-2 text-sm rounded-lg transition duration-300 w-full justify-center ${loading\r\n                            ? 'bg-gray-300 text-gray-600 cursor-not-allowed'\r\n                            : 'bg-sky-600 text-white hover:bg-sky-700'\r\n                            }`}\r\n                    >\r\n                        <FaSearch className={`mr-2 ${loading ? 'animate-pulse' : ''}`} />\r\n                        {loading ? 'Fetching...' : 'Apply Date Filter'}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            {/* END: Filter Row (Date Filters) */}\r\n\r\n            {/* START: Multi-Level Filters Row */}\r\n            <div className=\"bg-white p-4 rounded-lg shadow-sm mb-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <div className=\"flex items-center space-x-2 w-full\">\r\n                    <label htmlFor=\"countryFilter\" className=\"text-sm font-medium text-gray-700 flex-shrink-0\">Country:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"countryFilter\"\r\n                        placeholder=\"e.g. United States (Full Match)\"\r\n                        value={countryFilter}\r\n                        onChange={(e) => setCountryFilter(e.target.value)}\r\n                        className=\"p-2 border border-gray-300 rounded-lg w-full text-sm\"\r\n                        disabled={loading}\r\n                    />\r\n                </div>\r\n                <div className=\"flex items-center space-x-2 w-full\">\r\n                    <label htmlFor=\"regionFilter\" className=\"text-sm font-medium text-gray-700 flex-shrink-0\">Region:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"regionFilter\"\r\n                        placeholder=\"e.g. California (Full Match)\"\r\n                        value={regionFilter}\r\n                        onChange={(e) => setRegionFilter(e.target.value)}\r\n                        className=\"p-2 border border-gray-300 rounded-lg w-full text-sm\"\r\n                        disabled={loading}\r\n                    />\r\n                </div>\r\n                <div className=\"flex items-center space-x-2 w-full\">\r\n                    <label htmlFor=\"deviceCategoryFilter\" className=\"text-sm font-medium text-gray-700 flex-shrink-0\">Device:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"deviceCategoryFilter\"\r\n                        placeholder=\"e.g. desktop (Full Match)\"\r\n                        value={deviceCategoryFilter}\r\n                        onChange={(e) => setDeviceCategoryFilter(e.target.value)}\r\n                        className=\"p-2 border border-gray-300 rounded-lg w-full text-sm\"\r\n                        disabled={loading}\r\n                    />\r\n                </div>\r\n                <div className=\"md:col-span-3\">\r\n                    <button\r\n                        onClick={handleSearchClick}\r\n                        disabled={loading}\r\n                        className={`flex items-center px-4 py-2 text-sm rounded-lg transition duration-300 w-full justify-center ${loading\r\n                            ? 'bg-gray-300 text-gray-600 cursor-not-allowed'\r\n                            : 'bg-green-600 text-white hover:bg-green-700'\r\n                            }`}\r\n                    >\r\n                        <FaSearch className=\"mr-2\" /> Apply Multi-Level Filters\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            {/* END: Multi-Level Filters Row */}\r\n\r\n            <div className=\"bg-white rounded-lg shadow-lg overflow-x-auto\">\r\n                {error && (\r\n                    <div className=\"p-4 bg-red-100 text-red-700 border-l-4 border-red-500 flex items-center\">\r\n                        <FaExclamationTriangle className=\"mr-3 flex-shrink-0 text-xl\" />\r\n                        <div>\r\n                            <p className=\"font-semibold\">{error}</p>\r\n                            <p className=\"text-sm\">Please check the date range and ensure the scheduled job is running successfully to import new data.</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                {loading && data.length === 0 ? (\r\n                    <div className=\"p-6 text-center text-gray-500\">\r\n                        <FaRedo className=\"mx-auto text-3xl mb-2 animate-spin\" />\r\n                        <p>Loading historical report for selected dates...</p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"min-w-full divide-y divide-gray-200\">\r\n                        <thead className=\"bg-gray-50\">\r\n                            <tr>\r\n                                {columns.map(col => (\r\n                                    <th\r\n                                        key={col.key}\r\n                                        className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap\"\r\n                                    >\r\n                                        {col.title}\r\n                                    </th>\r\n                                ))}\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                            {data.length > 0 ? (\r\n                                data.map((item, index) => (\r\n                                    <tr key={item.id || index} className=\"hover:bg-sky-50/50\">\r\n                                        {columns.map(col => (\r\n                                            <td key={col.key} className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                {col.render(item)}\r\n                                            </td>\r\n                                        ))}\r\n                                    </tr>\r\n                                ))\r\n                            ) : (\r\n                                !error && (\r\n                                    <tr>\r\n                                        <td colSpan={columns.length} className=\"px-6 py-12 text-center text-gray-500\">\r\n                                            <FaChartBar className=\"mx-auto text-4xl mb-4 text-gray-400\" />\r\n                                            <p className=\"text-lg font-semibold\">No visitor data found for the selected date range.</p>\r\n                                            <p className=\"text-sm\">If this is the first day after implementation, initial data might be pending synchronization. Check back tomorrow.</p>\r\n                                        </td>\r\n                                    </tr>\r\n                                )\r\n                            )}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AudiencePage;"],"names":["DetailCell","_ref","icon","Icon","value","label","_jsxs","className","children","_jsx","title","getTodayDateString","Date","toISOString","split","AudiencePage","data","setData","useState","loading","setLoading","error","setError","startDate","setStartDate","endDate","setEndDate","countryFilter","setCountryFilter","regionFilter","setRegionFilter","deviceCategoryFilter","setDeviceCategoryFilter","lastFetchTime","setLastFetchTime","fetchData","async","start","end","country","region","deviceCategory","response","getHistoricalAudienceData","err","console","status","useEffect","today","defaultStart","getTime","handleDateChange","e","type","target","handleSearchClick","columns","key","render","item","FaCalendarAlt","sessionDate","FaMapMarkedAlt","concat","city","FaMobileAlt","deviceModel","FaGlobe","operatingSystem","osVersion","FaDesktop","screenResolution","sessionSource","landingPage","FaClock","timeOnSiteFormatted","FaChartBar","views","FaUser","userIdentifier","substring","htmlFor","id","onChange","disabled","onClick","FaSearch","placeholder","FaExclamationTriangle","length","FaRedo","map","col","index","colSpan"],"sourceRoot":""}