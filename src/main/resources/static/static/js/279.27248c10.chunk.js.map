{"version":3,"file":"static/js/279.27248c10.chunk.js","mappings":"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","sources":["components/ResponsiveAuthImage.js","components/ShareButtons.js","components/TableOfContents.js","pages/SinglePostPage.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\r\nimport 'react-lazy-load-image-component/src/effects/blur.css';\r\nimport { API_URL } from '../apiConfig';\r\nimport { decode } from 'blurhash';\r\n\r\n/**\r\n * BlurHashCanvas\r\n * Draws a decoded blurhash into a canvas sized to fill its parent.\r\n * Props:\r\n * - blurHash (string)\r\n * - width (number)\r\n * - height (number)\r\n */\r\nconst BlurHashCanvas = ({ blurHash, width, height }) => {\r\n    const canvasRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (!blurHash || !canvasRef.current || !width || !height) return;\r\n        // Choose a small decoded size for speed — will be upscaled by the canvas.\r\n        const decodedWidth = 32;\r\n        const decodedHeight = Math.max(1, Math.round((decodedWidth * height) / width));\r\n        let pixels;\r\n        try {\r\n            pixels = decode(blurHash, decodedWidth, decodedHeight); // returns Uint8ClampedArray rgba\r\n        } catch (e) {\r\n            console.warn('Failed to decode blurhash:', e);\r\n            return;\r\n        }\r\n        const ctx = canvasRef.current.getContext('2d');\r\n        // Create ImageData and put on canvas\r\n        const imageData = ctx.createImageData(decodedWidth, decodedHeight);\r\n        imageData.data.set(pixels);\r\n        // draw to small canvas then upscale to fill\r\n        const tmp = document.createElement('canvas');\r\n        tmp.width = decodedWidth;\r\n        tmp.height = decodedHeight;\r\n        const tmpCtx = tmp.getContext('2d');\r\n        tmpCtx.putImageData(imageData, 0, 0);\r\n\r\n        // Now scale to visible canvas\r\n        const canvas = canvasRef.current;\r\n        canvas.width = canvas.clientWidth;\r\n        canvas.height = canvas.clientHeight;\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        ctx.imageSmoothingEnabled = true;\r\n        ctx.drawImage(tmp, 0, 0, tmp.width, tmp.height, 0, 0, canvas.width, canvas.height);\r\n    }, [blurHash, width, height]);\r\n\r\n    // canvas fills container via absolute inset styles in parent\r\n    return <canvas ref={canvasRef} className=\"absolute inset-0 w-full h-full block\" aria-hidden=\"true\" />;\r\n};\r\n\r\n/**\r\n* ResponsiveAuthImage\r\n* Props:\r\n* - baseName: string (the backend image id / base filename)\r\n* - alt: string\r\n* - className: string (applied to the <img>)\r\n* - sizes: string (for srcSet)\r\n* - onLoad: function\r\n* - width, height: numbers (image metadata - used to set aspect ratio in parent)\r\n* - blurHash: string (if available render blurhash canvas)\r\n* - eager: boolean (if true, renders a high-priority <img> tag instead of lazy-loading)\r\n*/\r\nconst ResponsiveAuthImage = ({ baseName, alt, className = '', sizes, onLoad, width, height, blurHash, eager = false }) => {\r\n    // --- MODIFIED: Moved state hook to top ---\r\n    const [loaded, setLoaded] = useState(false);\r\n\r\n    // Render a simple placeholder if baseName is invalid.\r\n    if (!baseName || typeof baseName !== 'string') {\r\n        return <div className={`bg-gray-200 w-full h-full ${className}`} />;\r\n    }\r\n\r\n    const uuidRegex = /([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})/;\r\n    const match = baseName.match(uuidRegex);\r\n\r\n    let imageID;\r\n    if (match) {\r\n        imageID = match[0]; // Standard UUID path\r\n    } else {\r\n        // Fallback path: Use the baseName itself, stripping a potential .webp extension\r\n        // This allows for images like 'cover-image.webp'\r\n        imageID = baseName.endsWith('.webp') ? baseName.slice(0, -5) : baseName;\r\n    }\r\n\r\n    // Construct image URLs\r\n    const src = `${API_URL}/api/uploads/${imageID}-small.webp`;\r\n    const placeholderSrc = `${API_URL}/api/uploads/${imageID}-tiny.webp`; // tiny fallback if blurHash not present\r\n    const srcSet = [\r\n        `${API_URL}/api/uploads/${imageID}-small.webp 300w`,\r\n        `${API_URL}/api/uploads/${imageID}-medium.webp 600w`,\r\n        `${API_URL}/api/uploads/${imageID}.webp 1200w`\r\n    ].join(', ');\r\n\r\n    // --- (useState hook was here, but has been moved up) ---\r\n\r\n    const handleAfterLoad = (event) => {\r\n        setLoaded(true);\r\n        if (typeof onLoad === 'function') onLoad(event);\r\n    };\r\n\r\n    // EAGER loading: Render a standard <img> tag for LCP (Largest Contentful Paint)\r\n    // This bypasses the blur/lazy-load logic entirely for critical images.\r\n    if (eager) {\r\n        return (\r\n            <img\r\n                alt={alt}\r\n                src={src}\r\n                srcSet={srcSet}\r\n                sizes={sizes}\r\n                className={className}\r\n                onLoad={handleAfterLoad}\r\n                fetchpriority=\"high\"\r\n                // Pass width/height if available, though layout is controlled by className\r\n                {...(width && { width })}\r\n                {...(height && { height })}\r\n            />\r\n        );\r\n    }\r\n\r\n    // LAZY loading (default): Wrapper is full-size of parent.\r\n    return (\r\n        <div className=\"w-full h-full relative overflow-hidden bg-gray-100\">\r\n            {/* If blurHash provided and we have metadata, render the canvas placeholder */}\r\n            {blurHash && width && height ? (\r\n                <BlurHashCanvas blurHash={blurHash} width={width} height={height} />\r\n            ) : (\r\n                // Fallback tiny image — will be visible until main image loads.\r\n                <img\r\n                    src={placeholderSrc}\r\n                    alt={alt || ''}\r\n                    className=\"absolute inset-0 w-full h-full object-cover block\"\r\n                    aria-hidden=\"true\"\r\n                    style={{ transform: 'scale(1.02)' }}\r\n                />\r\n            )}\r\n\r\n            {/* Real image (lazy loaded) */}\r\n            <LazyLoadImage\r\n                alt={alt}\r\n                src={src}\r\n                srcSet={srcSet}\r\n                sizes={sizes}\r\n                // do not provide placeholderSrc to library when we already rendered our placeholder\r\n                effect={null}\r\n                className={`${className} transition-opacity duration-500 ${loaded ? 'opacity-100' : 'opacity-0'}`}\r\n                afterLoad={handleAfterLoad}\r\n                // Eager path is handled above, so this is always 'lazy'\r\n                loading={'lazy'}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ResponsiveAuthImage;","import React from 'react';\r\nimport {\r\n    FacebookShareButton,\r\n    LinkedinShareButton,\r\n    WhatsappShareButton,\r\n    TelegramShareButton,\r\n    TwitterShareButton, // Reverted to TwitterShareButton\r\n} from 'react-share';\r\nimport {\r\n    FacebookIcon,\r\n    LinkedinIcon,\r\n    WhatsappIcon,\r\n    TelegramIcon,\r\n    TwitterIcon, // Reverted to TwitterIcon\r\n} from 'react-share';\r\nimport { FaCopy } from 'react-icons/fa';\r\n\r\nconst ShareButtons = ({ url, title, summary }) => {\r\n    const handleCopy = () => {\r\n        navigator.clipboard.writeText(url);\r\n        alert('Link copied to clipboard!');\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-wrap items-center gap-4 mt-8\">\r\n            <span className=\"font-bold text-gray-700 text-lg mr-2\">Share this article:</span>\r\n            <div className=\"flex items-center gap-3\">\r\n                <TwitterShareButton url={url} title={title}>\r\n                    <TwitterIcon size={40} round />\r\n                </TwitterShareButton>\r\n\r\n                <FacebookShareButton url={url} quote={summary}>\r\n                    <FacebookIcon size={40} round />\r\n                </FacebookShareButton>\r\n\r\n                <LinkedinShareButton url={url} title={title} summary={summary}>\r\n                    <LinkedinIcon size={40} round />\r\n                </LinkedinShareButton>\r\n\r\n                <WhatsappShareButton url={url} title={title} separator=\":: \">\r\n                    <WhatsappIcon size={40} round />\r\n                </WhatsappShareButton>\r\n\r\n                <TelegramShareButton url={url} title={title}>\r\n                    <TelegramIcon size={40} round />\r\n                </TelegramShareButton>\r\n\r\n                <button\r\n                    onClick={handleCopy}\r\n                    className=\"flex items-center justify-center w-10 h-10 bg-gray-200 rounded-full hover:bg-gray-300 transition\"\r\n                    aria-label=\"Copy link\"\r\n                    title=\"Copy Link\"\r\n                >\r\n                    <FaCopy className=\"text-gray-600\" />\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ShareButtons;","// src/components/TableOfContents.js\r\nimport React, { useState } from 'react';\r\n\r\nconst TableOfContents = ({ headings, activeId, progress }) => {\r\n  const [isExpanded, setIsExpanded] = useState(true);\r\n  if (!headings || headings.length === 0) return null;\r\n\r\n  const handleLinkClick = (e, id) => {\r\n    e.preventDefault();\r\n    const element = document.getElementById(id);\r\n    if (element) {\r\n        // Adjust for sticky main navbar height (approx 80px-100px)\r\n        const yOffset = -90; \r\n        const y = element.getBoundingClientRect().top + window.pageYOffset + yOffset;\r\n        window.scrollTo({top: y, behavior: 'smooth'});\r\n    }\r\n  };\r\n\r\n  return (\r\n    // UPDATED: Added relative positioning for the progress bar\r\n    <div className=\"toc-container\">\r\n      {/* NEW: Vertical Progress Bar */}\r\n      <div className=\"toc-progress-track\">\r\n        <div className=\"toc-progress-fill\" style={{ height: `${progress}%` }}></div>\r\n      </div>\r\n\r\n      {/* UPDATED: Added left padding to avoid overlapping the progress bar */}\r\n      <div className=\"pl-5\">\r\n        <button onClick={() => setIsExpanded(!isExpanded)} className=\"toc-header\">\r\n          <span>On this page</span>\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" className={`toc-chevron ${isExpanded ? '' : '-rotate-90'}`}>\r\n            <path fillRule=\"evenodd\" d=\"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z\" clipRule=\"evenodd\" />\r\n          </svg>\r\n        </button>\r\n        {isExpanded && (\r\n          <nav className=\"toc-body\">\r\n            <ul>\r\n              {headings.map((heading) => (\r\n                <li key={heading.id} className=\"toc-list-item\">\r\n                  <a href={`#${heading.id}`} \r\n                     onClick={(e) => handleLinkClick(e, heading.id)}\r\n                     className={`toc-link ${activeId === heading.id ? 'active' : ''}`}\r\n                     style={{ paddingLeft: `${(heading.level - 2) * 0.75 + 0.5}rem` }}>\r\n                    {heading.text}\r\n                  </a>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </nav>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TableOfContents;","import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { getPostByUrlId, API_URL } from '../apiConfig';\r\nimport DOMPurify from 'dompurify';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport ResponsiveAuthImage from '../components/ResponsiveAuthImage';\r\nimport ShareButtons from '../components/ShareButtons';\r\nimport throttle from 'lodash/throttle';\r\nimport TableOfContents from '../components/TableOfContents';\r\n\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return 'N/A';\r\n    return new Date(dateString).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });\r\n};\r\n\r\nconst createSnippet = (html, length = 155) => {\r\n    if (!html) return '';\r\n    const plainText = DOMPurify.sanitize(html, { ALLOWED_TAGS: [] });\r\n    if (plainText.length <= length) return plainText;\r\n    const trimmed = plainText.substring(0, length);\r\n    return trimmed.substring(0, Math.min(trimmed.length, trimmed.lastIndexOf(' '))) + '...';\r\n};\r\n\r\nconst SinglePostPage = () => {\r\n    const { urlArticleId } = useParams();\r\n    const [post, setPost] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [headings, setHeadings] = useState([]);\r\n    const [activeId, setActiveId] = useState('');\r\n    const [progress, setProgress] = useState(0);\r\n    const articleRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const fetchPost = async () => {\r\n            try {\r\n                const response = await getPostByUrlId(urlArticleId);\r\n                setPost(response.data);\r\n            } catch (err) {\r\n                setError('Failed to fetch post.');\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        fetchPost();\r\n        window.scrollTo(0, 0);\r\n    }, [urlArticleId]);\r\n\r\n    useEffect(() => {\r\n        if (!post?.content) return;\r\n        const tempDiv = document.createElement('div');\r\n        tempDiv.innerHTML = DOMPurify.sanitize(post.content, { USE_PROFILES: { html: true }, ADD_ATTR: ['id'] });\r\n        \r\n        const headingElements = tempDiv.querySelectorAll('h2, h3, h4');\r\n        const extractedHeadings = Array.from(headingElements).map((el, index) => {\r\n            const id = `heading-${index}-${el.tagName}`;\r\n            el.id = id;\r\n            return { id, text: el.innerText, level: parseInt(el.tagName.substring(1), 10) };\r\n        });\r\n\r\n        setHeadings(extractedHeadings);\r\n        setPost(currentPost => ({ ...currentPost, contentWithIds: tempDiv.innerHTML }));\r\n    }, [post?.content]);\r\n    \r\n    const handleScroll = useMemo(() => throttle(() => {\r\n        const contentElement = articleRef.current;\r\n        if (!contentElement) return;\r\n\r\n        const articleTop = contentElement.getBoundingClientRect().top + window.scrollY;\r\n        const contentHeight = contentElement.scrollHeight;\r\n        const viewportHeight = window.innerHeight;\r\n\r\n        const scrollableDistance = contentHeight - viewportHeight;\r\n        const scrolledFromTop = window.scrollY - articleTop;\r\n        \r\n        if (scrolledFromTop > 0 && scrollableDistance > 0) {\r\n            const scrollPercent = (scrolledFromTop / scrollableDistance) * 100;\r\n            setProgress(Math.min(100, Math.max(0, scrollPercent)));\r\n        } else {\r\n            setProgress(0);\r\n        }\r\n\r\n        let currentActiveId = '';\r\n        for (let i = headings.length - 1; i >= 0; i--) {\r\n            const element = document.getElementById(headings[i].id);\r\n            if (element && element.getBoundingClientRect().top < 200) {\r\n                currentActiveId = headings[i].id;\r\n                break;\r\n            }\r\n        }\r\n        setActiveId(currentActiveId);\r\n    }, 150), [headings]);\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('scroll', handleScroll);\r\n        return () => {\r\n            handleScroll.cancel();\r\n            window.removeEventListener('scroll', handleScroll);\r\n        };\r\n    }, [handleScroll]);\r\n\r\n    if (loading) return <div className=\"text-center py-20\">Loading post...</div>;\r\n    if (error) return <div className=\"text-center py-20 text-red-500\">{error}</div>;\r\n    if (!post) return <div className=\"text-center py-20\">Post not found.</div>;\r\n\r\n    const createMarkup = (htmlContent) => ({ __html: htmlContent });\r\n\r\n    // UPDATED URL\r\n    const pageUrl = `https://treishfin.treishvaamgroup.com/category/${post.category?.slug}/${post.userFriendlySlug}/${post.urlArticleId}`;\r\n    const pageTitle = `Treishvaam Finance · ${post.title}`;\r\n    const seoDescription = post.metaDescription || post.customSnippet || createSnippet(post.content, 155);\r\n    const imageUrl = post.coverImageUrl ? `${API_URL}/api/uploads/${post.coverImageUrl}.webp` : `${window.location.origin}/logo512.png`;\r\n    const homeUrl = window.location.origin;\r\n\r\n    const schema = {\r\n        \"@context\": \"https://schema.org\",\r\n        \"@type\": \"Article\",\r\n        \"headline\": post.title,\r\n        \"image\": imageUrl,\r\n        \"author\": {\r\n            \"@type\": \"Organization\",\r\n            \"name\": \"Treishvaam Finance\",\r\n            \"url\": homeUrl\r\n        },\r\n        \"publisher\": {\r\n            \"@type\": \"Organization\",\r\n            \"name\": \"Treishvaam Finance\",\r\n            \"logo\": {\r\n                \"@type\": \"ImageObject\",\r\n                \"url\": `${homeUrl}/logo512.png`\r\n            }\r\n        },\r\n        \"datePublished\": post.createdAt,\r\n        \"dateModified\": post.updatedAt,\r\n        \"mainEntityOfPage\": {\r\n            \"@type\": \"WebPage\",\r\n            \"@id\": pageUrl\r\n        },\r\n        \"description\": seoDescription,\r\n        \"keywords\": post.keywords || post.tags?.join(', ')\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Helmet>\r\n                <title>{pageTitle}</title>\r\n                <meta name=\"description\" content={seoDescription} />\r\n                {post.keywords && <meta name=\"keywords\" content={post.keywords} />}\r\n                <link rel=\"canonical\" href={pageUrl} />\r\n                <meta property=\"og:type\" content=\"article\" />\r\n                <meta property=\"og:url\" content={pageUrl} />\r\n                <meta property=\"og:title\" content={post.title} />\r\n                <meta property=\"og:description\" content={seoDescription} />\r\n                <meta property=\"og:image\" content={imageUrl} />\r\n                <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n                <meta name=\"twitter:url\" content={pageUrl} />\r\n                <meta name=\"twitter:title\" content={post.title} />\r\n                <meta name=\"twitter:description\" content={seoDescription} />\r\n                <meta name=\"twitter:image\" content={imageUrl} />\r\n                <script type=\"application/ld+json\">\r\n                    {JSON.stringify(schema)}\r\n                </script>\r\n            </Helmet>\r\n\r\n            <div className=\"max-w-screen-xl mx-auto lg:grid lg:grid-cols-12 lg:gap-x-12 px-4 sm:px-6 lg:px-8\">\r\n                <div className=\"lg:col-span-8 xl:col-span-9 py-8\">\r\n                    <header className=\"mb-8\">\r\n                        <h1 className=\"text-3xl md:text-5xl font-extrabold text-gray-900 leading-tight\">\r\n                            {post.title}\r\n                        </h1>\r\n                        <div className=\"flex items-center text-sm text-gray-500 mt-4 mb-6\">\r\n                            <span>By {post.author || 'Treishvaam Team'}</span>\r\n                            <span className=\"mx-2\">·</span>\r\n                            <time dateTime={post.createdAt}>{formatDate(post.createdAt)}</time>\r\n                        </div>\r\n                        \r\n                        {post.coverImageUrl && (\r\n                            <div className=\"mb-8 rounded-lg overflow-hidden shadow-lg\">\r\n                                <ResponsiveAuthImage baseName={post.coverImageUrl} alt={post.coverImageAltText || post.title} className=\"w-full h-auto object-cover\"/>\r\n                            </div>\r\n                        )}\r\n                    </header>\r\n                    \r\n                    <main ref={articleRef}>\r\n                        <article className=\"prose prose-lg max-w-none\" dangerouslySetInnerHTML={createMarkup(post.contentWithIds || post.content)} />\r\n                        \r\n                        <div className=\"mt-16 pt-8 border-t\">\r\n                            <ShareButtons url={pageUrl} title={post.title} />\r\n                        </div>\r\n                    </main>\r\n                </div>\r\n\r\n                <aside className=\"lg:col-span-4 xl:col-span-3 py-8 hidden lg:block\">\r\n                    <div className=\"sticky top-24\">\r\n                         <TableOfContents \r\n                            headings={headings} \r\n                            activeId={activeId} \r\n                            progress={progress} \r\n                         />\r\n                    </div>\r\n                </aside>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default SinglePostPage;"],"names":["BlurHashCanvas","_ref","blurHash","width","height","canvasRef","useRef","useEffect","current","decodedHeight","Math","max","round","pixels","decode","e","console","warn","ctx","getContext","imageData","createImageData","data","set","tmp","document","createElement","putImageData","canvas","clientWidth","clientHeight","clearRect","imageSmoothingEnabled","drawImage","_jsx","ref","className","_ref2","baseName","alt","sizes","onLoad","eager","loaded","setLoaded","useState","concat","match","imageID","endsWith","slice","src","API_URL","placeholderSrc","srcSet","join","handleAfterLoad","event","_objectSpread","fetchpriority","_jsxs","children","style","transform","LazyLoadImage","effect","afterLoad","loading","url","title","summary","TwitterShareButton","TwitterIcon","size","FacebookShareButton","quote","FacebookIcon","LinkedinShareButton","LinkedinIcon","WhatsappShareButton","separator","WhatsappIcon","TelegramShareButton","TelegramIcon","onClick","handleCopy","navigator","clipboard","writeText","alert","FaCopy","headings","activeId","progress","isExpanded","setIsExpanded","length","xmlns","viewBox","fill","fillRule","d","clipRule","map","heading","href","id","handleLinkClick","preventDefault","element","getElementById","yOffset","y","getBoundingClientRect","top","window","pageYOffset","scrollTo","behavior","paddingLeft","level","text","SinglePostPage","_post$category","_post$tags","urlArticleId","useParams","post","setPost","setLoading","error","setError","setHeadings","setActiveId","setProgress","articleRef","async","response","getPostByUrlId","err","fetchPost","content","tempDiv","innerHTML","DOMPurify","sanitize","USE_PROFILES","html","ADD_ATTR","headingElements","querySelectorAll","extractedHeadings","Array","from","el","index","tagName","innerText","parseInt","substring","currentPost","contentWithIds","handleScroll","useMemo","throttle","contentElement","articleTop","scrollY","scrollableDistance","scrollHeight","innerHeight","scrolledFromTop","scrollPercent","min","currentActiveId","i","addEventListener","cancel","removeEventListener","pageUrl","category","slug","userFriendlySlug","pageTitle","seoDescription","metaDescription","customSnippet","arguments","undefined","plainText","ALLOWED_TAGS","trimmed","lastIndexOf","createSnippet","imageUrl","coverImageUrl","location","origin","homeUrl","schema","createdAt","updatedAt","keywords","tags","_Fragment","Helmet","name","rel","property","type","JSON","stringify","author","dateTime","dateString","Date","toLocaleDateString","year","month","day","ResponsiveAuthImage","coverImageAltText","dangerouslySetInnerHTML","htmlContent","__html","ShareButtons","TableOfContents"],"sourceRoot":""}